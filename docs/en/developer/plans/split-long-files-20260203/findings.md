# Findings

## 2026-02-03
- Repository root includes backend, frontend, shared, docs, and design-system directories; this will guide where to scan for long files to split. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Planning session initialized with hash split-long-files-20260203 using the planning-with-files script. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Long files identified (top counts): frontend/src/styles.css (4330), frontend/src/pages/RepoDetailPage.tsx (2859), backend/src/agent/agent.ts (2244), backend/src/modules/repositories/repositories.controller.ts (1868), frontend/src/components/UserPanelPopover.tsx (1823), frontend/src/pages/TaskGroupChatPage.tsx (1754), backend/src/modules/tasks/task.service.ts (1328), backend/src/modules/tasks/preview.service.ts (854), backend/src/modules/repositories/repository.service.ts (778), frontend/src/pages/AppShell.tsx (811), plus several others around 400-650 lines. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Docs assets also include large files (docs/.docusaurus/routes.js, docs/src/css/custom.css, docs/src/components/openapi/index.tsx) which may need splitting if within scope. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- frontend/src/styles.css contains a mix of theme tokens, global layout rules, component-specific styles, and page-level sections; it is a strong candidate to split into themed CSS modules (tokens, base, components, pages). docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- styles.css has clear comment-delimited sections (tokens, sidebar, list cards, task detail, preview panel, execution logs, settings) which can map to separate CSS modules with ordered @imports. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- styles.css includes discrete blocks for app shell/sidebar, shared page layout + PageNav, tasks page filters, card list layouts, and task detail meta cards; these can be split into themed CSS files under a styles/ directory with ordered imports. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- styles.css includes discrete repo detail and task detail layout blocks (summary strips, dashboards, activity cards, sidebar/workflow layout) that can move into dedicated repo-detail.css and task-detail.css modules. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- RepoDetailPage.tsx defines many helper types/constants alongside a large main component; it only exposes a small ModelPickerField subcomponent and the page component, suggesting helper extraction into dedicated modules (constants, onboarding helpers, form helpers) while keeping the page component as an orchestrator. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- styles.css contains large sections for preview panel chrome, chat timeline, log viewer/execution viewer, markdown output, login, and user panel modal styling; these map naturally to preview.css, chat.css, log-viewer.css, markdown.css, login.css, and user-panel.css modules. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- styles.css ends with user panel/settings navigation, theme selection cards, modern chat composer styles, and Ant Design override rules; these can split into user-panel.css, settings.css, composer.css, and antd-overrides.css to reduce merge conflicts. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- styles.css is imported in frontend/src/main.tsx and referenced by tests (frontend/src/tests/stylesThemeTokens.test.ts, stylesAntdInputs.test.ts) that read raw styles.css text; splitting must update these tests to read the new module structure. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Docs references to styles.css are mostly in historical plan/progress notes; since styles.css remains, doc updates are not required for those links. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Preview panel styles start around `.hc-preview-panel` (~line 2048) and run through the preview media queries/animations before chat timeline resumes at `.hc-chat-welcome` (~line 2530), so the chat/preview section can be split into preview.css and chat.css without reordering other rules. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- User panel styles include a settings/nav subsection starting near `.hc-settings-nav-item` (~line 3604) and theme card preview styles starting around line 3815, so user-panel.css and settings.css can be separated cleanly. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- app-shell.css is dominated by sidebar (`.hc-sider*`) rules; only `.hc-shell` and `.hc-content` are shell-level, so it can be split into app-shell.css (shell/content) and sidebar.css (sidebar/nav) to bring each file under 400 lines. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- preview.css groups layout/header/browser chrome with diagnostics/log output (starting around `.hc-preview-diagnostics` and `.hc-preview-log-*`), so it can be split into preview-shell.css and preview-logs.css to keep each under 400 lines. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- repo-detail.css separates full-width layout/summary strip from detailed activity/dashboard styles (starting around `.hc-repo-activity`), enabling a split into repo-detail-layout.css and repo-detail-activity.css. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- execution.css contains distinct sections: diff tokens at the top, dialog/timeline styles, ThoughtChain layout (around line 300+), and diff rendering (around line 578+); these can be split into execution-dialog.css, execution-thoughtchain.css, and execution-diff.css while keeping diff tokens centralized. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- sidebar.css is still >400 lines; it can be split into sidebar-shell.css (container/brand/scroll), sidebar-sections.css (section header/count/toggle), and sidebar-items.css (item rows, view-all, menu styles) based on the `.hc-sider-section*` grouping. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Sidebar styles break cleanly into three chunks: shell/nav (top/brand/scroll/bottom), section headers/toggles, and item rows/menu/empty states, which will be split into separate sidebar CSS modules. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- sidebar.css split points: `.hc-sider__sectionHeaderRow` starts around line 161, and `.hc-sider-item.ant-btn` starts around line 307, making it straightforward to slice shell vs section vs item blocks. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- execution.css splits cleanly around `.hc-exec-thought-chain` (~line 365), `.hc-exec-code` (~line 478), and `.hc-exec-diff-list` (~line 541), allowing separate modules for dialog/timeline, thought-chain layout, and diff rendering. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- After splitting styles.css, remaining 400+ line files are primarily TS/TSX/JS/TS backend/frontend modules (RepoDetailPage.tsx, agent.ts, repositories.controller.ts, UserPanelPopover.tsx, TaskGroupChatPage.tsx, TaskDetailPage.tsx, task.service.ts, i18n message files, AppShell.tsx, tests, and several services/utilities) plus docs/src/css/custom.css and docs/src/components/openapi/index.tsx. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- docs/src/css/custom.css already has sectioned comments (tokens, layout background, navbar/logo, menu, code blocks, buttons, tables, typography, OpenAPI panels, reduced motion), making it suitable to split into modular CSS files with an @import aggregator. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- docs/src/components/openapi/index.tsx bundles OpenAPI types, storage helpers, utilities, context/provider, settings form, and operation card rendering; it can be split into types.ts, utils.ts, storage.ts, context.tsx, settings.tsx, and operation-card.tsx with index.tsx re-exports. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- After splitting docs custom.css and the OpenAPI component, remaining 400+ line files are concentrated in frontend pages/components/tests and backend services/controllers (list unchanged from earlier except docs assets removed). docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- i18n message files en-US.ts and zh-CN.ts are long but already structured with `// --- Section ---` markers; they can be split into section modules and merged in the locale entry files while preserving MessageKey typing. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Both locale files share consistent section markers (App/Common/Sidebar/... Conversation), which can be grouped into themed modules (core, repos, automation, user-panel, chat/execution, demo) and merged in the locale entry files. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- executionLog.ts has clear clusters: type definitions, generic parsing helpers, Claude-specific parsing, and timeline reducers/builders; it can be split into executionLog/types.ts, executionLog/parsers.ts, and executionLog/timeline.ts with a small barrel file. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- task.tsx contains multiple helper clusters (status/tag helpers, queued hints, title/marker formatting, sidebar labels, extraction utilities, event tags, target link parsing) and can be split into smaller task utility modules with a barrel export. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- shared/preview-bridge.js is referenced in docs/en/user-docs/preview.md (copy/import instructions), so splitting it into modules will require updating that doc to reference the new folder or bundled entry. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- Remaining 400+ line files after splitting i18n, api types, task utils, and preview bridge: large frontend pages/components/tests plus backend controllers/services/model providers (list above). docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- RepoDetailProviderActivityRow uses Dropdown/Tag/Tooltip/Typography only in the activity row renderer; moving that renderer into a helper module will let the main component drop those imports and fall below 400 lines. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- RepoOnboardingWizard.tsx renders five step-specific blocks (step 0-4) inline; extracting each step into its own component (or at least chat/webhook steps) will reduce the main file below 400 lines. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
<!-- Document the updated scan of long source files and the RepoOnboardingWizard breakage for follow-up work. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203 -->
- A focused scan of src directories shows the remaining long files to split are concentrated in frontend pages/components/tests and backend services/controllers; generated build/dist artifacts and lockfiles are excluded from scope. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
<!-- Flag the partial RepoOnboardingWizard refactor state for immediate repair. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203 -->
- RepoOnboardingWizard.tsx currently has missing React hook imports and duplicate visibility helper definitions due to partial refactor, so it needs to be rewired to the new onboarding hooks before continuing. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- TaskGroupChatPage timeline tests now need to scroll the `.hc-chat-body` container to load older tasks because the load-more button no longer exists, and the auto-pin logic is driven by Resize/Mutation observers (not window resize). docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
- AppShell.tsx had a JSX comment inserted without a fragment wrapper, which breaks the frontend test transform until the user panel slot is wrapped in a fragment. docs/en/developer/plans/split-long-files-20260203/task_plan.md split-long-files-20260203
